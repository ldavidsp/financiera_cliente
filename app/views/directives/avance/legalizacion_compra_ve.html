<div class="panel panel-primary panel-body" >
    <h2 class="page-header text-center" >
      {{'LEGALIZACION_EVENTO_COMPRA' | translate }}
    </h2>
    <div class="panel-body">
      <form class="form-horizontal" name="compras" ng-submit="compras.$valid && d_legalizacionCompraVe.add_edit_compras()">
        <br>
        <div class="row">
          <label for="CodigoAbreviacion" class="col-sm-3 control-label">{{'DOCUMENTO_NIT' | translate }}:</label>
          <div class="col-sm-6">
            <input name="CodigoAbreviacion" type="text" ng-model="d_legalizacionCompraVe.LegalizacionCompras.Tercero" class="form-control" required ng-disabled="ver" />
          </div>
            <div class="col-sm-1">
              <center>
                <a type="button" name="button" ng-click="d_legalizacionCompraVe.cargar_proveedor()" class="fa fa-search btn btn-info btn-outline" aria-hidden="true"></a>
              </center>
            </div>
            <div class="col-sm-2">
              <loading load="estudiante_cargado" tam=1 clase="clase_load"></loading>
              <div class="alert alert-warning" ng-if="encontrado">
                <strong>{{'NO_ENCONTRADO_RESULTADOS' | translate }} {{'DOCUMENTO_NIT' | translate }} {{d_legalizacionCompraVe.Codigo}}</strong>
              </div>
            </div>
          </div>
          <br>
          <div class="row">
            <label for="nombre" class="col-sm-3 control-label">{{'NOMBRE' | translate }}:</label>
            <div class="col-sm-8">
              <span class="form-control">{{d_legalizacionCompraVe.LegalizacionCompras.InformacionProveedor[0].NomProveedor}}</span>
            </div>
          </div>
          <br>
          <div class="row">
            <label for="tipo_ingreso" class="col-sm-3 control-label">{{'FECHA_COMPRA_EVENTO' | translate}}:</label>
            <md-datepicker ng-model="d_legalizacionCompraVe.LegalizacionCompras.FechaCompra" md-placeholder="{{'FECHA' | translate}}" required ng-disabled = "!ver"></md-datepicker>
          </div>
          <br>
          <div class="row">
            <label for="descripcion" class="col-sm-3 control-label">{{'NO_FACTURA' | translate }}:</label>
            <div class="col-sm-6">
              <input name="CodigoAbreviacion" type="text" ng-model="d_legalizacionCompraVe.LegalizacionCompras.NumeroFactura" class="form-control input_right" required ng-disabled = "!ver"/>
                    </div>
            </div>
            <br>
            <div class="row">
              <label for="descripcion" class="col-sm-3 control-label">{{'VALOR_FACTURA_COMPRA' | translate }}:</label>
              <div class="col-sm-6">
                <input name="CodigoAbreviacion" ng-change="d_legalizacionCompraVe.calcular_valor_impuesto()" type="text" ng-model="d_legalizacionCompraVe.LegalizacionCompras.Valor" ui-money-mask="0" class="form-control input_right" required ng-disabled = "!ver"/>
                    </div>
              </div>
              <br>
              <div class="row">
                <label for="descripcion" class="col-sm-3 control-label">{{'TRM_COMPRA' | translate }}:</label>
                <div class="col-sm-6">
                  <input name="CodigoAbreviacion" type="text" ng-model="d_legalizacionCompraVe.LegalizacionCompras.TrmFechaCompra" ui-money-mask="0" class="form-control input_right" required ng-disabled = "!ver"/>
                    </div>
                  <div class="col-sm-3">
                    <label for="descripcion"><small>{{'TRM_COMPRA_DESCRIPCION' | translate }}</small></label>
                  </div>
                </div>
                <br>
                        <legend class="text-primary" ng-click="d=!d">{{'IMPUESTOS'| translate}}
                          <span class="fa fa-plus pull-right" ng-show="!d"></span>
                          <span class="fa fa-minus pull-right" ng-show="d"></span>
                       </legend>
                        <div class="panel panel-default" ng-show="d">
                            <div>
                            <div id="my-grid" ui-grid="d_legalizacionCompraVe.gridImpuestos" ui-grid-auto-resize ui-grid-selection ui-grid-pagination></div>
                            </div>
                          <br>
                         <div class="col-md-12">
                           <div class="panel panel-default panel-body col-md-6" ng-repeat="item in d_legalizacionCompraVe.Impuesto track by $index">
                             <div class="panel-heading">
                               <label for="descripcion" class="control-label">{{item.TipoCuentaEspecial.Nombre}}</label>
                             </div>
                             <fieldset>
                               <div style="padding-top:2%">
                                 <span >{{item.Descripcion}}</span>
                              </div>
                               <div class="col-md-6" style="padding-top:2%">
                                 <div style="display:inline-block">
                                 <span  class="control-label" style="width:30%;text-align:left;display:inline-block"><strong>Porcentaje:</strong></span>
                                 <input  class = "form-control input_right" type="text" disabled ng-model="item.Porcentaje" style="width:40%;display:inline-block" ui-percentage-mask />
                               </div>
                               <div style="display:inline-block">
                                 <span  class="control-label" style="width:30%;text-align:left;display:inline-block"><strong>Valor:</strong></span>
                                   <input  class = "form-control input_right" type="text"disabled ng-model="item.Valor" ui-money-mask="0" style="width:40%;display:inline-block" />
                              </div>
                                   </div>
                                 </fieldset>
                               </div>
                             </div>
                          </div>
                        <hr>
                        <div class="col-md-12">
                          <div class="row" >
                            <label for="descripcion" class="control-label" style="width:5%;text-align:left;display:inline-block">{{'SUBTOTAL' | translate }}:</label>
                            <input name="CodigoAbreviacion" type="text" disabled ng-model="d_legalizacionCompraVe.subtotal" class="form-control" style="width:10%;text-align:left;display:inline-block" ui-money-mask="0" disabled/>
                          </div>

                          <div class="row" style="padding-top:1%">
                            <label for="descripcion" class="control-label" style="width:5%;text-align:left;display:inline-block">{{'TOTAL' | translate }}:</label>
                            <input name="CodigoAbreviacion" type="text" disabled ng-model="d_legalizacionCompraVe.Total" class="form-control" style="width:10%;text-align:left;display:inline-block" ui-money-mask="0" disabled/>
                          </div>
                        </div>
                        <br>
      </form>
    </div>

    <div class="panel-body" >
      <legend class="text-primary" ng-click="ic = !ic" >
        {{'CONCEPTOS' | translate}}
        <span class="fa fa-plus pull-right" ng-show="!ic"></span>
        <span class="fa fa-minus pull-right" ng-show="ic"></span>
      </legend class="text-primary">
      <div ng-if="ic" >

        <div class="col-md-12" form-group >
           <fieldset class="form-group">
          <arbol-conceptos filtro="d_legalizacionCompraVe.filtro_ingresos" seleccion="d_legalizacionCompraVe.concepto[0]" conceptosel="nodo" recargar="d_legalizacionCompraVe.recargar" rdesc notloadconcepto="true"> </arbol-conceptos>
         </fieldset>
        </div>


    </div>
  </div>

  <div class="panel-body" >
    <legend class="text-primary" ng-show="d_legalizacionCompraVe.concepto[0]" ng-click="ap=!ap">
      {{'AFECTACION_PRESUPUESTAL' | translate}}
      <span class="fa fa-plus pull-right" ng-show="!ap"></span>
      <span class="fa fa-minus pull-right" ng-show="ap"></span>
    </legend class="text-primary">
      <div class="col-md-12" ng-if="ap">
        <div class="row">
          <div class="panel-default panel-body">
            <ul class="list-unstyled">
              <li><b>{{'RUBRO' | translate}}:</b> {{d_legalizacionCompraVe.concepto[0].Rubro.Codigo+" / "+d_legalizacionCompraVe.concepto[0].Rubro.Nombre}}
                <ul>
                  <li>
                    <div class="col-md-4" style="width:148px">
                      <label for="valAfectacion">{{'VALOR_AFECTACION' | translate}}:</label>
                    </div>
                    <div class="col-md-4" style="width:200px">
                      <span class="form-control" style="height:25px">{{d_legalizacionCompraVe.subtotal|currency}}</span>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>

    </div>



    <div class="panel-body" >
          <legend class="text-primary" ng-show="d_legalizacionCompraVe.concepto[0]"  ng-click="inc=!inc">
            {{'CUENTAS_CONTABLES' | translate}}
            <span class="fa fa-plus pull-right" ng-show="!inc"></span>
            <span class="fa fa-minus pull-right" ng-show="inc"></span>
          </legend class="text-primary">

        <div class="col-sm-12" ng-show="inc">
          <div class="panel-body">
            <ul class="nav nav-tabs">
              <li ng-class="{active: selected == c.Id}" ng-repeat="c in d_legalizacionCompraVe.concepto"><a href ng-click="d_legalizacionCompraVe.selected=c.Id" data-toggle="tab">
                                  Concepto: [ {{c.Codigo}} ]  {{c.Nombre}}</a>
              </li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
              <div class="tab-pane fade in active" ng-repeat="c in d_legalizacionCompraVe.concepto" ng-show="d_legalizacionCompraVe.selected==c.Id">
                <movimientos-contables conceptoid="c.Id" movimientos="c.movimientos" monto="d_legalizacionCompraVe.subtotal" selcuentas editable impuestos= "d_legalizacionCompraVe.Impuesto" validatemov="c.validado">
                </movimientos-contables>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel-footer">
        <center>
          <input  ng-click="d_legalizacionCompraVe.limpiar_compra()" class="btn btn-info btn-outline" value="{{'BTN.LIMPIAR' | translate }}" ng-if="ver" />
          <input class="btn btn-success btn-outline" value="{{'BTN.GUARDAR' | translate }}" ng-click="d_legalizacionCompraVe.guardar()" ng-if="ver" />
        </center>
      </div>
  </div>
